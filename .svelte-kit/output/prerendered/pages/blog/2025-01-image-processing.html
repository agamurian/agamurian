<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	
		<link href="../_app/immutable/assets/0.DOoRdZMi.css" rel="stylesheet">
		<link href="../_app/immutable/assets/8.9ghhGv4B.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.CX8IIVdc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dkjl7EFX.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/LvNdeKyf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BSTOWzBo.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BjHfPZ7_.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.CE7xcZnO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DWzqSfxI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BtzwvMBs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DgQZ3w3Q.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C5vp_C0f.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cv-OK6qP.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CC0uOOOu.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CTrRe5wz.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.VOC0vfyR.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BbaS0uwr.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1XTtcoT.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CbWk8usL.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/2.C-YAiDyL.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/8.Bf4htGvj.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cy2ZQmBQ.js"><!--12qhfyh--><link rel="icon" href="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='107'%20height='128'%20viewBox='0%200%20107%20128'%3e%3ctitle%3esvelte-logo%3c/title%3e%3cpath%20d='M94.157%2022.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282%2029.608A29.92%2029.92%200%200%200%208.764%2049.65a31.5%2031.5%200%200%200%203.108%2020.231%2030%2030%200%200%200-4.477%2011.183%2031.9%2031.9%200%200%200%205.448%2024.116c10.402%2014.887%2030.942%2019.297%2045.791%209.835l26.083-16.624A29.92%2029.92%200%200%200%2098.235%2078.35a31.53%2031.53%200%200%200-3.105-20.232%2030%2030%200%200%200%204.474-11.182%2031.88%2031.88%200%200%200-5.447-24.116'%20style='fill:%23ff3e00'/%3e%3cpath%20d='M45.817%20106.582a20.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.503%2018%2018%200%200%201%20.624-2.435l.49-1.498%201.337.981a33.6%2033.6%200%200%200%2010.203%205.098l.97.294-.09.968a5.85%205.85%200%200%200%201.052%203.878%206.24%206.24%200%200%200%206.695%202.485%205.8%205.8%200%200%200%201.603-.704L69.27%2076.28a5.43%205.43%200%200%200%202.45-3.631%205.8%205.8%200%200%200-.987-4.371%206.24%206.24%200%200%200-6.698-2.487%205.7%205.7%200%200%200-1.6.704l-9.953%206.345a19%2019%200%200%201-5.296%202.326%2020.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.502%2017.99%2017.99%200%200%201%208.13-12.052l26.081-16.623a19%2019%200%200%201%205.3-2.329%2020.72%2020.72%200%200%201%2022.237%208.243%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-.624%202.435l-.49%201.498-1.337-.98a33.6%2033.6%200%200%200-10.203-5.1l-.97-.294.09-.968a5.86%205.86%200%200%200-1.052-3.878%206.24%206.24%200%200%200-6.696-2.485%205.8%205.8%200%200%200-1.602.704L37.73%2051.72a5.42%205.42%200%200%200-2.449%203.63%205.79%205.79%200%200%200%20.986%204.372%206.24%206.24%200%200%200%206.698%202.486%205.8%205.8%200%200%200%201.602-.704l9.952-6.342a19%2019%200%200%201%205.295-2.328%2020.72%2020.72%200%200%201%2022.237%208.242%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-8.13%2012.053l-26.081%2016.622a19%2019%200%200%201-5.3%202.328'%20style='fill:%23fff'/%3e%3c/svg%3e"/><!----><!--1teoznn--><meta name="description" content="Explore the fundamentals of digital image processing and how to apply convolutions, filters, and transformations to create stunning visual effects."/> <meta property="og:title" content="Image Processing: From Theory to Practice"/> <meta property="og:description" content="Explore the fundamentals of digital image processing and how to apply convolutions, filters, and transformations to create stunning visual effects."/> <meta property="og:type" content="article"/> <meta property="og:image" content="/og-image.png"/> <meta name="twitter:card" content="summary_large_image"/><!----><title>Image Processing: From Theory to Practice - Blog</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&display=swap" rel="stylesheet">
</head>

<body data-sveltekit-preload-data="hover">
	<div style="display: contents"><!--[--><!--[--><!----><div class="nav svelte-1elxaub"><div class="border-part svelte-1elxaub"><div class="left-part svelte-1elxaub"><a class="item svelte-1elxaub" href="/">Main</a> <a class="item svelte-1elxaub" href="/projects">Projects</a> <a class="item svelte-1elxaub" href="/contacts">Contacts</a> <a class="item svelte-1elxaub" href="/gallery">Gallery</a> <a class="item svelte-1elxaub" href="/blog">Blog</a></div> <div class="center-part svelte-1elxaub"></div> <div class="right-part svelte-1elxaub">v2.0 <button class="switcher svelte-u8uo5a">ðŸŒ‘ï¸Ž</button><!----></div></div></div><!----> <canvas class="three-bg-canvas"></canvas> <div class="container"><!--[--><!--[--><!----><!----><article class="section blog-post"><div class="blog-header svelte-1teoznn" style="opacity:1"><div class="blog-meta svelte-1teoznn"><span class="author">By Andrey Golovin</span> <span class="separator svelte-1teoznn">â€¢</span> <time class="date">January 15, 2025</time> <span class="separator svelte-1teoznn">â€¢</span> <span class="reading-time">12 min read</span></div> <div class="tags svelte-1teoznn" style="opacity:1"><!--[--><span class="tag svelte-1teoznn">#image-processing</span><span class="tag svelte-1teoznn">#algorithms</span><span class="tag svelte-1teoznn">#python</span><!--]--></div></div> <div class="blog-content svelte-1teoznn"><!----><h1 id="image-processing-from-theory-to-practice">Image Processing: From Theory to Practice</h1> <h2 id="introduction">Introduction</h2> <p>Digital image processing is one of the most exciting fields in computer science and graphics. Whether youâ€™re building photo editing software, creating artistic effects, or developing computer vision systems, understanding image processing is essential.</p> <p>In this post, weâ€™ll explore:</p> <ul><li>Fundamental concepts like pixels and color spaces</li> <li>Common filters and their applications</li> <li>Building your own image processor</li> <li>Real-world performance considerations</li></ul> <h2 id="part-1-understanding-pixels-and-color-spaces">Part 1: Understanding Pixels and Color Spaces</h2> <h3 id="rgb-and-beyond">RGB and Beyond</h3> <p>Every digital image is composed of pixels arranged in a 2D grid. Each pixel contains color information, most commonly in RGB (Red, Green, Blue) format.</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># Load an image</span>
img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'example.jpg'</span><span class="token punctuation">)</span>
pixels <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img<span class="token punctuation">)</span>

<span class="token comment"># pixels.shape gives us (height, width, 3) for RGB</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Image dimensions: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>pixels<span class="token punctuation">.</span>shape<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code><!----></pre> <h3 id="working-with-channels">Working with Channels</h3> <p>Each color channel can be manipulated independently:</p> <pre class="language-python"><!----><code class="language-python"><span class="token comment"># Extract individual channels</span>
red_channel <span class="token operator">=</span> pixels<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
green_channel <span class="token operator">=</span> pixels<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
blue_channel <span class="token operator">=</span> pixels<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># Create a grayscale image</span>
grayscale <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>pixels<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></code><!----></pre> <h2 id="part-2-filters-and-convolutions">Part 2: Filters and Convolutions</h2> <h3 id="kernel-based-filtering">Kernel-Based Filtering</h3> <p>Convolution is the mathematical operation that powers most image filters. A kernel (small matrix) is slid across the image, computing weighted sums.</p> <p><strong>Common kernels:</strong></p> <pre class="language-python"><!----><code class="language-python"><span class="token comment"># Blur kernel (3x3)</span>
blur_kernel <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">9</span>

<span class="token comment"># Sharpen kernel</span>
sharpen_kernel <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Sobel edge detection (X direction)</span>
sobel_x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code><!----></pre> <h3 id="applying-convolution">Applying Convolution</h3> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> scipy <span class="token keyword">import</span> signal

<span class="token keyword">def</span> <span class="token function">apply_filter</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Apply a convolution filter to an image."""</span>
    filtered <span class="token operator">=</span> signal<span class="token punctuation">.</span>convolve2d<span class="token punctuation">(</span>
        image<span class="token punctuation">,</span>
        kernel<span class="token punctuation">,</span>
        mode<span class="token operator">=</span><span class="token string">'same'</span><span class="token punctuation">,</span>
        boundary<span class="token operator">=</span><span class="token string">'symm'</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>filtered<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

<span class="token comment"># Apply blur</span>
blurred <span class="token operator">=</span> apply_filter<span class="token punctuation">(</span>grayscale<span class="token punctuation">,</span> blur_kernel<span class="token punctuation">)</span>

<span class="token comment"># Apply edge detection</span>
edges <span class="token operator">=</span> apply_filter<span class="token punctuation">(</span>grayscale<span class="token punctuation">,</span> sobel_x<span class="token punctuation">)</span></code><!----></pre> <h2 id="part-3-advanced-techniques">Part 3: Advanced Techniques</h2> <h3 id="histogram-equalization">Histogram Equalization</h3> <p>Improve contrast by redistributing pixel intensities:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">def</span> <span class="token function">histogram_equalization</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Improve image contrast using histogram equalization."""</span>
    hist<span class="token punctuation">,</span> bins <span class="token operator">=</span> np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>image<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    cdf <span class="token operator">=</span> hist<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cdf_normalized <span class="token operator">=</span> cdf <span class="token operator">*</span> hist<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> cdf<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># Map old values to new values</span>
    cdf_m <span class="token operator">=</span> np<span class="token punctuation">.</span>ma<span class="token punctuation">.</span>masked_equal<span class="token punctuation">(</span>cdf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    cdf_m <span class="token operator">=</span> <span class="token punctuation">(</span>cdf_m <span class="token operator">-</span> cdf_m<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span> <span class="token operator">/</span> <span class="token punctuation">(</span>cdf_m<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cdf_m<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cdf <span class="token operator">=</span> np<span class="token punctuation">.</span>ma<span class="token punctuation">.</span>filled<span class="token punctuation">(</span>cdf_m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'uint8'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> cdf<span class="token punctuation">[</span>image<span class="token punctuation">]</span></code><!----></pre> <h3 id="bilateral-filtering">Bilateral Filtering</h3> <p>Preserve edges while smoothing:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>ndimage <span class="token keyword">import</span> gaussian_filter

<span class="token keyword">def</span> <span class="token function">bilateral_filter</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> sigma_spatial<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> sigma_intensity<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Edge-preserving blur filter."""</span>
    h<span class="token punctuation">,</span> w <span class="token operator">=</span> image<span class="token punctuation">.</span>shape
    result <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>image<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># This is simplified; production code would optimize this</span>
            pixel_intensity <span class="token operator">=</span> image<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
            
            <span class="token comment"># Gaussian spatial weight</span>
            x_dist <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            y_dist <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># Apply weights...</span>
            
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span></code><!----></pre> <h2 id="part-4-performance-optimization">Part 4: Performance Optimization</h2> <h3 id="using-numpy-vectorization">Using NumPy Vectorization</h3> <pre class="language-python"><!----><code class="language-python"><span class="token comment"># SLOW: Python loops</span>
slow_result <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        slow_result<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> image<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span>

<span class="token comment"># FAST: NumPy vectorization</span>
fast_result <span class="token operator">=</span> image <span class="token operator">*</span> <span class="token number">2</span></code><!----></pre> <h3 id="gpu-acceleration-with-cupy">GPU Acceleration with CuPy</h3> <p>For large images or real-time processing:</p> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">import</span> cupy <span class="token keyword">as</span> cp

<span class="token keyword">def</span> <span class="token function">gpu_blur</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Fast blur using GPU."""</span>
    gpu_image <span class="token operator">=</span> cp<span class="token punctuation">.</span>asarray<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
    kernel <span class="token operator">=</span> cp<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">9</span>
    result <span class="token operator">=</span> cp<span class="token punctuation">.</span>convolve<span class="token punctuation">(</span>gpu_image<span class="token punctuation">,</span> kernel<span class="token punctuation">)</span>
    <span class="token keyword">return</span> cp<span class="token punctuation">.</span>asnumpy<span class="token punctuation">(</span>result<span class="token punctuation">)</span></code><!----></pre> <h2 id="practical-example-creating-an-artistic-filter">Practical Example: Creating an Artistic Filter</h2> <pre class="language-python"><!----><code class="language-python"><span class="token keyword">def</span> <span class="token function">artistic_filter</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> blur_amount<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> edge_threshold<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Create a stylized artistic effect."""</span>
    <span class="token comment"># Step 1: Bilateral filter for smoothing</span>
    smoothed <span class="token operator">=</span> bilateral_filter<span class="token punctuation">(</span>image<span class="token punctuation">,</span> blur_amount<span class="token punctuation">)</span>
    
    <span class="token comment"># Step 2: Detect edges</span>
    edges <span class="token operator">=</span> apply_filter<span class="token punctuation">(</span>smoothed<span class="token punctuation">,</span> sobel_x<span class="token punctuation">)</span>
    
    <span class="token comment"># Step 3: Create mask where edges are strong</span>
    edge_mask <span class="token operator">=</span> edges <span class="token operator">></span> edge_threshold
    
    <span class="token comment"># Step 4: Posterize (reduce colors)</span>
    posterized <span class="token operator">=</span> <span class="token punctuation">(</span>smoothed <span class="token operator">//</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span>
    
    <span class="token comment"># Step 5: Combine</span>
    result <span class="token operator">=</span> posterized<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    result<span class="token punctuation">[</span>edge_mask<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># Black edges</span>
    
    <span class="token keyword">return</span> result</code><!----></pre> <h2 id="conclusion">Conclusion</h2> <p>Image processing is a vast field with applications from medical imaging to artistic creation. The techniques covered here form the foundation for more advanced work. Experiment with different kernels, combine filters, and discover your own effects!</p> <h3 id="further-reading">Further Reading</h3> <ul><li>OpenCV (cv2) - Industry standard library</li> <li>scikit-image - Academic/scientific focus</li> <li>GIMP Plugin Development - Apply these concepts to a real application</li></ul> <hr/> <p><em>What image processing projects are you working on? Share in the comments!</em></p><!----></div> <div class="blog-footer svelte-1teoznn"><hr/> <h4>About the Author</h4> <p><strong>Andrey Golovin</strong> is a software developer and digital artist</p> <div class="post-navigation svelte-1teoznn"><!--[!--><!--]--> <!--[--><a href="/blog/2025-02-shaders-explained" class="nav-link next svelte-1teoznn">Shaders 101: How They Transform Your Graphics â†’</a><!--]--></div></div></article><!----><!----><!----><!--]--><!--]--></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_rd1uai = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.CX8IIVdc.js"),
						import("../_app/immutable/entry/app.CE7xcZnO.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 8],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
</body>


</html>
